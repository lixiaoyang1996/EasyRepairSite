<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <h1>
            修改维修类别
            <small>修改一条维修类别</small>
        </h1>
        <ol class="breadcrumb">
            <li><a href="{:U('Admin/Index/index')}"><i class="fa fa-dashboard"></i>控制面板</a></li>
            <li><a href="{:U('Admin/Type/index')}">维修类别管理</a></li>
            <li><a href="#">修改维修类别</a></li>
        </ol>
    </section>

    <!-- Main content -->
    <section class="content container-fluid">

        <!--------------------------
          | Your Page Content Here |
          -------------------------->
        <div class="box box-primary">
            <!-- form start -->
            <form role="form">
                <input type="hidden" name="id" value="{$type.id}">
                <div class="box-body">
                    <div class="form-group">
                        <label for="name">类别名/品牌名</label>
                        <input type="text" class="form-control" id="name" name="name" value="{$type.name}">
                    </div>
                    <div class="form-group">
                        <label>所属分类</label>
                        <select class="form-control" name="pid">
                            <option value="0"
                            <if condition="$type['pid'] eq 0">selected</if>
                            >一级分类</option>
                            <foreach name="ptypes" item="ptype">
                                <option disabled>二级分类</option>
                                <option value="{$ptype.id}"
                                <if condition="$type['pid'] eq $ptype['id']">selected</if>
                                >{$ptype.name}</option>
                                <foreach name="ctypes" item="ctype">
                                    <if condition="$ctype['pid'] eq $ptype['id']">
                                        <option disabled>三级分类</option>
                                        <option value="{$ctype.id}"
                                        <if condition="$type['pid'] eq $ctype['id']">selected</if>
                                        >{$ptype.name}---{$ctype.name}</option>
                                    </if>
                                </foreach>
                            </foreach>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="sort">排序</label>
                        <input type="number" class="form-control" id="sort" name="sort" value="{$type.sort}">
                    </div>
                    <div class="form-group">
                        <label>显示状态</label>
                        <div class="radio">
                            <label>
                                <input type="radio" name="show" value="1"
                                <if condition="$type['show'] eq 1">checked</if>
                                >
                                显示
                            </label>&nbsp;&nbsp;
                            <label>
                                <input type="radio" name="show" value="0"
                                <if condition="$type['show'] eq 0">checked</if>
                                >
                                隐藏
                            </label>
                        </div>
                    </div>
                </div>
                <!-- /.box-body -->

                <div class="box-footer">
                    <button type="button" onclick="save('{:U('Admin/Type/save')}')" class="btn btn-primary">保存
                    </button>
                </div>
            </form>
            <!-- /.box-body -->
        </div>
    </section>
    <!-- /.content -->
</div>
<!-- /.content-wrapper -->
<script>
    function save(url) {
        $.ajax({
            url: url,
            type: 'post',
            data: $('form').serializeArray(),
            dataType: 'json',
            success: function (response) {
                layer.msg(response.message, {
                    icon: response.code,
                    time: 600
                }, function () {
                    if (response.url) {
                        window.location.href = response.url;
                    }
                });
            }
        });
    }
</script>